<!DOCTYPE html>
<meta charset="utf-8">
<style>

.link {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

#licensing {
  fill: green;
}

.link.licensing {
  stroke: green;
}

.link.resolved {
  stroke-dasharray: 0,2 1;
}

circle {
  fill: #ccc;
  stroke: #333;
  stroke-width: 1.5px;
}

text {
  font: 10px sans-serif;
  pointer-events: none;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
}

</style>
<body>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script>

var links = [
{% for item in links %}
{from_level:"{{item.from_level}}", from_pos:"{{item.from_pos}}",to_level:"{{item.to_level}}", to_pos:"{{item.to_pos}}"},
{%- endfor %}
];

var nodes = [
{% for item in nodes %}
{name:"{{item.name}}", level:{{item.level}}, pos:{{item.pos}} },
{%- endfor %}
];


var zoom = d3.behavior.zoom()
      .scaleExtent([0.1, 2])
      .on('zoom', redraw);

function redraw() {
  g.attr('transform', 'translate(' + d3.event.translate + ')' +
      ' scale(' + d3.event.scale + ')');
}
var diagonal = d3.svg.diagonal()
      .projection(function(d) {return [d.x, d.y]; });

var svg = d3.select("body").append("svg")
    .attr("width", "95vw")
    .attr("height", "95vh")
    .call(zoom);

var g = svg.append("g");

g.selectAll("circle")
  .data(nodes)
  .enter()
  .append("circle")
  .attr("id", function(d) { return d.name; })
  .attr("cx", function(d) { return 50+d.pos*100; })
  .attr("cy", function(d) { return 50+d.level*30; })
  .attr("r", function(d) { return 5; })
  ;

g.selectAll("text")
  .data(nodes)
  .enter()
  .append("text")
  .attr("x", function(d) { return 60+d.pos*100; })
  .attr("y", function(d) { return 55+d.level*30; })
  .text(function(d) { return d.name; })
  ;

g.selectAll("link")
  .data(links)
  .enter()
  .append("line")
  .attr("class", ".link")
  .attr("x1", function (d){ return 50+d.from_pos*100; })
  .attr("y1", function (d){ return 50+d.from_level*30; })
  .attr("x2", function (d){ return 50+d.to_pos*100; })
  .attr("y2", function (d){ return 50+d.to_level*30; })



</script>
